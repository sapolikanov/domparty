---
title: "Models"
subtitle: "Project: Dominant Party Regimes in Sub-Saharan Africa"
format: 
  pdf:
    fig-pos: "H"
    fontsize: 11pt
    highlight-style: breezedark
    fig-width: 7
    fig-height: 5
    include-in-header: 
      - file: ../preamble.tex
execute: 
  echo: true
  warning: false
  message: false
---

This file reports the modelling process and the associated analytic decisions. It also includes the results of sensitivity tests.

```{r}
#| label: setup
#| include: false

library(here)
source(here("utilities", "check_packages.R"))
source(here("utilities", "functions.R"))

theme_set(theme_minimal())
```

Read in the data compiled in the *data_building.qmd* file.

```{r}
#| label: read in data

data <- read_rds(here("data", "data_built", "data.built.rds"))
```

The main and only model in my original work was a multinomial logistic model. The main disadvantage of using this class of models in this context is that logistic models typically require more observations than linear models. Nevertheless, I start with a multinomial model to i) establish a baseline, ii) provide ground to validate the analytical coding of the dominant party regimes and iii) because there are not many alternative methods to analyze the data.

I first use a preferred specification, with party system institutionalization and education variables imputed with the mean of 2013-2018 values for the country with missing data, ELF imputed with previous values for the country and oil rents variable presented as a dummy.

```{r}
#| label: multinom-pref
#| results: hide

m1a <- multinom(party_reg ~ v2xps_party_mean + elf_fill + col_type
               + housesys + v2x_polyarchy + oil_rent_dummy + e_peaveduc_mean,
               data = data)

m1b <- multinom(relevel(party_reg, ref = "Autocratic Dominant") 
                ~ v2xps_party_mean + elf_fill + col_type
                + housesys + v2x_polyarchy + oil_rent_dummy + e_peaveduc_mean,
               data = data)
```

```{r}
#| label: tbl-multinom-pref
#| tbl-cap: Multinomial logistic model, preferred specification

modelsummary(list("Ref: Non-dominant" = m1a, 
                  "Ref: Autocratic Dominant" = m1b), stars = T, 
             shape = term ~ response, coef_rename = T, 
             output = "kableExtra") |> 
  kable_styling(latex_options = c("scale_down"))
```

```{r}
#| label: fig-check-multinom-pref
#| fig-height: 4

check_model(m1a)
```

@tbl-multinom-pref reveals that there are not many valid inferences to be drawn from this way of modelling the data. While democracy scores are correlated with whether the dominant regime will be autocratic or democratic dominant, this is really not a significant contribution and is indeed to be expected. Other variables that reach conventional significance levels do so when I compare both dominant regime types with non-dominant regimes. This suggests that the model is too underpowered to capture differences between autocratic and democratic dominant regimes. 

With this in mind, I try and confirm this with a continuous measure of party dominance: ENPP. 

```{r}
#| label: tbl-lm-enpp-pref
#| tbl-cap: Linear model with ENPP as the dependent, all specifications

m2 <- lm(enpp ~ v2xps_party_mean + elf_fill + col_type
         + housesys + v2x_polyarchy + oil_rent_dummy + e_peaveduc_mean,
         data = data)

m2a <- lm(enpp ~ v2xps_party_next + elf_fill + col_type
         + housesys + v2x_polyarchy + oil_rent_dummy + e_peaveduc_mean,
         data = data)

m2b <- lm(enpp ~ v2xps_party_mean + elf_fill + col_type_collapsed
         + housesys + v2x_polyarchy + oil_rent_dummy + e_peaveduc_mean,
         data = data)

m2c <- lm(enpp ~ v2xps_party_mean + elf_fill + col_type
         + housesys + v2x_polyarchy + oil_rent_perc_gdp + e_peaveduc_mean,
         data = data)


modelsummary(list("Preferred" = m2, "PSI next year imputed" = m2a, 
                  "Oil rent in % of GDP" = m2b, "Colonial Legacy Collapsed" = m2c), 
             stars = T, coef_rename = T, 
             coef_map = c("(Intercept)", "PSI (Mean)", 
                          "PSI (Next Year Imputed)", "ELF (Imputed)", 
                          "Colonial Legacy [France]", 
                          "Colonial Legacy [Mixed]", 
                          "Colonial Legacy [None]", 
                          "Colonial Legacy [Other]", 
                          "Colonial Legacy (Collapsed) [France]",
                          "Colonial Legacy (Collapsed) [Other]", 
                          "Electoral Rules [Plural]", "Democracy",
                          "Oil Dummy [Not equal to zero]",
                          "Oil Rents (%)",
                          "Education (Mean Imputed)"),
             output = "kableExtra") |> 
  kable_styling(latex_options = c("scale_down")) |> 
  column_spec(column = 2:5, width = "2.5cm") 
```

\newpage

```{r}
#| label: fig-check-lm-enpp-pref
#| fig-cap: Model diagnostics for the preferred linear model with ENPP as the dependent variable.
#| fig-width: 9
#| fig-height: 7

check_model(m2)
```

When using ENPP as the dependent variable, linear models suggest similar results to those obtained using an analytical coding of the variable. While it is unsurprising, given the fact that party regime coding is based on the number of parties, it is nevertheless good to validate that approach. 

Substantively, when using different operationalizations of variables, several patterns remain stable. Firstly, if anything, the preferred specification underestimates the effect of party system institutionalization on party dominance. When using different variables and especially when utilizing an alternative imputation method for missing values, the negative effect of party system institutionalization is more pronounced. 

The interpretation for the latter is that the higher the party institutionalization score, the lower the expected number of parliamentary parties, that is, the higher the party dominance. This is in line with the theoretical expectations.
